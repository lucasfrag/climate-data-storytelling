<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Climate Date Storytelling</title>
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="./assets/css/leaflet.css" />
    <link rel="stylesheet" href="./assets/css/styles.css">

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light">

        <a class="navbar-brand" href="./index.html"> Meu Site</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Alternar navega√ß√£o">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item active"></li>
                <a class="nav-link" href="./index.html">In√≠cio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="./dashboard.html">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Artigo</a>
                </li>
            </ul>
        </div>

        <div class="d-flex justify-content-end">
            <a class="btn btn-outline-dark" href="https://github.com/lucasfrag/climate-data-storytelling"
                target="_blank">
                <i class="fab fa-github"></i> GitHub
            </a>
        </div>
    </nav>

    <!-- Se√ß√£o Principal -->
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 d-flex flex-column justify-content-center align-items-center vh-100">
                <img src="assets/images/bg.jpg" alt="Background" class="img-fluid"
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.5; z-index: -1;">
                <h1 class="text-center">Visualiza√ß√£o de Dados Clim√°ticos</h1>
                <h2></h2>
                <center>
                    <p>...</p>
                    <p>...</p>
                    <p>...</p>
                </center>

                <a href="#estacoes-meteorologicas">
                    <button class="btn btn-primary">Come√ßar agora</button>
                </a>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>


    <!--------------------------------------------------------------------------------------------------------------------------->

    <!-- Se√ß√£o Esta√ß√µes Meteorol√≥gicas -->
    <div class="container-fluid" id="temperatura-media-anual">
        <div class="row">

            <!-- Storytelling -->
            <div class="col-sm-12 col-md-12 col-lg-6" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light mb-3 text-primary" id="estacoes-title" style="margin-top: 50px; background-color: #f8f9fa;" tabindex="0">
                        <i class="fas fa-cloud-sun-rain me-2"></i> Esta√ß√µes Meteorol√≥gicas
                    </h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <p>As esta√ß√µes meteorol√≥gicas s√£o fundamentais para o monitoramento do clima e previs√£o do tempo. Elas coletam dados essenciais, como <strong>temperatura</strong>, <strong>umidade</strong>, <strong>press√£o atmosf√©rica</strong> e <strong>precipita√ß√£o</strong>, que ajudam a entender as condi√ß√µes clim√°ticas em diferentes regi√µes.</p>
                        <p>O <a href="https://portal.inmet.gov.br/">Instituto Nacional de Meteorologia (INMET)</a> opera uma rede de esta√ß√µes meteorol√≥gicas em todo o Brasil, fornecendo dados valiosos para pesquisadores, meteorologistas e o p√∫blico em geral. Essas informa√ß√µes s√£o cruciais para a previs√£o do tempo, planejamento agr√≠cola, gest√£o de recursos h√≠dricos e resposta a desastres naturais.</p>

                        <section aria-labelledby="estacoes-title">
                            <p>
                                <span class="badge bg-primary me-5 text-white">Dica</span>
                                <strong>Selecione um estado ou arraste o ano para ver as esta√ß√µes surgindo no mapa!</strong>
                            </p>
                            <form id="controls" class="d-flex flex-wrap align-items-center gap-3 mb-3" aria-label="Filtros de esta√ß√µes" style="padding: 8px 0;">
                                <label for="ufSelect" class="form-label mb-0 me-2" style="margin-right: 8px;">UF:</label>
                                <select id="ufSelect" class="form-select form-control me-3" style="width: 150px; margin-right: 12px;" aria-label="Filtrar por estado">
                                    <option value="TODOS">Todos</option>
                                </select>
                                <button id="playBtn" type="button" aria-label="Mostrar evolu√ß√£o das esta√ß√µes" title="Mostrar evolu√ß√£o das esta√ß√µes" class="btn btn-primary" aria-pressed="false" style="margin-left: 8px;">‚ñ∂Ô∏è Ver evolu√ß√£o das esta√ß√µes</button>
                                <button id="resetBtn" type="button" aria-label="Reiniciar mapa" title="Reiniciar mapa" class="btn btn-outline-secondary" style="margin-left: 8px;">üîÑ Reiniciar mapa</button>
                            </form>

                            <div id="yearSliderContainer" class="my-3">
                                <label for="yearSlider" id="yearSliderLabel" class="form-label"><strong>Ano:</strong> <span id="yearLabel">2020</span></label>
                                <input style="width: 100%;" type="range" id="yearSlider" min="2000" max="2025" value="2000" aria-labelledby="yearSliderLabel" />
                            </div>

                            <div class="mb-4 p-4 rounded shadow-sm bg-white border" id="charts" aria-label="Gr√°fico de esta√ß√µes por ano">
                                <canvas id="graficoEstacoes" role="img" aria-label="Gr√°fico de barras mostrando o n√∫mero de esta√ß√µes fundadas por ano"></canvas>
                                <p class="text-muted small mt-2">Dica: Clique em um marcador para saber mais sobre a esta√ß√£o.</p>
                            </div>

                        </section>
                        

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;" aria-label="Ir para a pr√≥xima se√ß√£o">
                                <span style="font-size: 1.5em; vertical-align: middle;" aria-hidden="true">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mapa -->
            <div class="col-sm-12 col-md-12 col-lg-6 justify-content-center align-items-center"
                style="background-color: #f8f9fa;">
                <div id="map"></div>
            </div>
        </div>
    </div>











    <div class="container-fluid" id="temperatura-media-anual">
        <div class="row" style="min-height: 800px;">

            <!-- Mapa -->
            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">
                <div id="map"></div>
            </div>

            <!-- Storytelling -->
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        üìà Temperatura M√©dia Anual</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <!--<h2 style="padding: 30px 0px 30px 0px; background-color: #f8f9fa;"></h2>-->
                        <p>...</p>
                        <p>...</p>

                        <div class="slide chart-container" id="slide-linha">
                            <svg id="grafico-linha"></svg>
                        </div>

                        <p>...</p>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <div class="container-fluid" id="">
        <div class="row" style="min-height: 800px;">
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        üåßÔ∏è Precipita√ß√£o Acumulada por Ano</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <p>Entre 2000 e 2025, Porto Alegre experimentou varia√ß√µes significativas na precipita√ß√£o
                            acumulada
                            anual, refletindo as mudan√ßas clim√°ticas e padr√µes meteorol√≥gicos em evolu√ß√£o. A an√°lise dos
                            dados pluviom√©tricos revela um aumento gradual, com picos not√°veis em anos espec√≠ficos.</p>
                        <p>Em 2000, a precipita√ß√£o acumulada anual foi de 1.200 mm, enquanto em 2025, essa m√©dia subiu
                            para
                            1.400 mm. Este aumento de 200 mm em apenas 25 anos destaca a urg√™ncia de a√ß√µes clim√°ticas e
                            a
                            necessidade de adapta√ß√£o √†s novas realidades clim√°ticas.</p>
                        <div class="slide chart-container" id="slide-area">
                            <svg id="grafico-area"></svg>
                        </div>
                        <p>O gr√°fico acima ilustra a evolu√ß√£o da precipita√ß√£o acumulada anual em Porto Alegre,
                            destacando
                            os anos com precipita√ß√µes mais altas e mais baixas. A linha ascendente indica uma tend√™ncia
                            preocupante, refor√ßando a necessidade de monitoramento cont√≠nuo e a√ß√µes para mitigar os
                            impactos das mudan√ßas clim√°ticas.</p>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">

            </div>
        </div>
    </div>

    <div class="container-fluid" id="">
        <div class="row" style="min-height: 800px;">
            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">

            </div>
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        üíß Umidade Relativa M√©dia Anual</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <p>Entre 2000 e 2025, Porto Alegre experimentou uma varia√ß√£o na umidade relativa m√©dia anual,
                            refletindo as mudan√ßas clim√°ticas e padr√µes meteorol√≥gicos em evolu√ß√£o. A an√°lise dos dados
                            de umidade revela uma tend√™ncia de aumento, com picos not√°veis em anos espec√≠ficos.</p>
                        <p>Em 2000, a umidade relativa m√©dia anual foi de 70%, enquanto em 2025, essa m√©dia subiu para
                            80%. Este aumento de 10% em apenas 25 anos destaca a
                            urg√™ncia de a√ß√µes clim√°ticas e a necessidade de adapta√ß√£o √†s novas realidades clim√°ticas.
                        </p>
                        <div class="slide chart-container" id="slide-umidade">
                            <svg id="grafico-umidade"></svg>
                        </div>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>


    <div class="container-fluid" id="">
        <div class="row" style="min-height: 800px;">
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        üå¨Ô∏è Velocidade M√©dia do Vento</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <p>Entre 2000 e 2025, Porto Alegre experimentou uma varia√ß√£o na velocidade m√©dia do vento,
                            refletindo as mudan√ßas clim√°ticas e padr√µes meteorol√≥gicos em evolu√ß√£o. A an√°lise dos dados
                            de vento revela uma tend√™ncia de aumento, com picos not√°veis em anos espec√≠ficos.</p>
                        <p>Em 2000, a velocidade m√©dia do vento foi de 2.4 m/s, enquanto em 2025, essa m√©dia subiu para
                            3.3 m/s. Este aumento de 0.9 m/s em apenas 25 anos destaca a urg√™ncia de a√ß√µes clim√°ticas e
                            a
                            necessidade de adapta√ß√£o √†s novas realidades clim√°ticas.</p>

                        <div class="slide chart-container" id="slide-vento">
                            <svg id="grafico-vento"></svg>
                        </div>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">

            </div>
        </div>
    </div>


    <div class="container-fluid" id="">
        <div class="row" style="min-height: 800px;">
            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">

            </div>
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        üî• Eventos de Temperatura Extrema</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <div class="slide chart-container" id="slide-extremos">
                            <svg id="grafico-extremos"></svg>
                        </div>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="container-fluid" id="">
        <div class="row" style="min-height: 800px;">
            <div class="col-md-6 d-flex flex-column" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <h1 class="bg-light" style="padding: 50px 0px 20px 0px; background-color: #f8f9fa;">
                        ‚ùÑÔ∏è Dias de Calor/Frio Intensos</h1>

                    <div class="col-12 justify-content-center align-items-center">
                        <div class="slide chart-container" id="slide-intensos">
                            <svg id="grafico-intensos"></svg>
                        </div>

                        <div class="end-content">
                            <button class="btn btn-primary rounded-circle" style="width: 50px; height: 50px;">
                                <span style="font-size: 1.5em; vertical-align: middle;">&#8595;</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 d-flex flex-column justify-content-center align-items-center"
                style="background-color: #f8f9fa;">

            </div>
        </div>
    </div>





    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

    






    <!-- Se√ß√£o Galeria de Imagens -->
    <div class="container-fluid" id="estacoes-meteorologicas">
        <div class="row">

            <!-- Storytelling -->
            <div class="col-md-6 d-flex flex-column vh-100" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column">
                    <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                        <h1 style="padding: 30px 0px 30px 0px; background-color: #f8f9fa;">...</h1>
                        <p>Conte√∫do da coluna 1.</p>
                        <button class="btn btn-primary">Clique aqui</button>
                    </div>
                </div>
            </div>

            <div class="col-md-6 d-flex flex-column vh-100" style="background-color: #f8f9fa;">
                <div class="col-12 d-flex flex-column hide-scrollbar" style="overflow-y: scroll;">

                    <div class="col-12 hv-100 d-flex flex-column justify-content-center align-items-center">
                        <h2 style="padding: 30px 0px 50px 0px; background-color: #f8f9fa;">2000</h2>
                        <div class="row">
                            <div class="col-lg-4 col-md-12 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(73).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain1.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>

                            <div class="col-lg-4 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain2.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(73).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>

                            <div class="col-lg-4 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(18).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain3.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>
                        </div>
                    </div>



                    <div class="col-12 hv-100 d-flex flex-column justify-content-center align-items-center">
                        <h2 style="padding: 30px 0px 50px 0px; background-color: #f8f9fa;">2024</h2>
                        <div class="row">
                            <div class="col-lg-4 col-md-12 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(73).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain1.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>

                            <div class="col-lg-4 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain2.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(73).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>

                            <div class="col-lg-4 mb-4 mb-lg-0">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/Nature/4-col/img%20(18).webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/Vertical/mountain3.webp"
                                    class="w-100 shadow-1-strong rounded mb-4" alt="..." />
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Rodap√© -->
    <footer class="bg-light text-center text-lg-start">
        <div class="text-center p-4" style="background-color: #f8f9fa;">
            2025 ¬© Todos os direitos reservados.
        </div>


        <script>
            // Dados de exemplo
            const dados = [
                { ano: 2000, temp: 21.3, chuva: 1200 },
                { ano: 2005, temp: 21.7, chuva: 1580 },
                { ano: 2010, temp: 22.4, chuva: 1420 },
                { ano: 2015, temp: 22.9, chuva: 1350 },
                { ano: 2020, temp: 23.5, chuva: 1480 },
                { ano: 2025, temp: 24.1, chuva: 1600 }
            ];

            const regioes = [
                { nome: "Zona Norte", x: 150, y: 100, temp: 22.4 },
                { nome: "Centro", x: 300, y: 200, temp: 23.1 },
                { nome: "Zona Sul", x: 500, y: 300, temp: 24.0 }
            ];

            const dadosVento = [
                { ano: 2000, vento: 2.4 },
                { ano: 2005, vento: 2.8 },
                { ano: 2010, vento: 3.1 },
                { ano: 2015, vento: 2.7 },
                { ano: 2020, vento: 3.3 }
            ];

            const dadosExtremos = [
                { ano: 2000, max: 39, min: 3 },
                { ano: 2005, max: 41, min: 2 },
                { ano: 2010, max: 43, min: 1 },
                { ano: 2015, max: 40, min: 4 },
                { ano: 2020, max: 42, min: 3 }
            ];

            const dadosIntensos = [
                { ano: 2000, calor: 18, frio: 10 },
                { ano: 2005, calor: 22, frio: 8 },
                { ano: 2010, calor: 26, frio: 6 },
                { ano: 2015, calor: 20, frio: 9 },
                { ano: 2020, calor: 25, frio: 7 }
            ];

            const direcoes = [
                { dir: "N", freq: 12 },
                { dir: "NE", freq: 18 },
                { dir: "E", freq: 22 },
                { dir: "SE", freq: 14 },
                { dir: "S", freq: 10 },
                { dir: "SO", freq: 8 },
                { dir: "O", freq: 6 },
                { dir: "NO", freq: 10 }
            ];

            // Sele√ß√£o do tooltip
            const tooltip = d3.select("#tooltip");

            // Vari√°veis para controle de anima√ß√£o
            const animacoes = {
                linha: false,
                area: false,
                mapa: false,
                umidade: false,
                vento: false,
                extremos: false,
                intensos: false,
                ventoDirecao: false
            };

            // Configura√ß√£o do IntersectionObserver para anima√ß√£o dos slides
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        switch (entry.target.id) {
                            case 'slide-linha':
                                if (!animacoes.linha) {
                                    animarLinha();
                                    animacoes.linha = true;
                                }
                                break;
                            case 'slide-area':
                                if (!animacoes.area) {
                                    animarArea();
                                    animacoes.area = true;
                                }
                                break;
                            case 'slide-mapa':
                                if (!animacoes.mapa) {
                                    animarMapa();
                                    animacoes.mapa = true;
                                }
                                break;
                            case 'slide-umidade':
                                if (!animacoes.umidade) {
                                    animarUmidade();
                                    animacoes.umidade = true;
                                }
                                break;
                            case 'slide-vento':
                                if (!animacoes.vento) {
                                    animarVento();
                                    animacoes.vento = true;
                                }
                                break;
                            case 'slide-extremos':
                                if (!animacoes.extremos) {
                                    animarExtremos();
                                    animacoes.extremos = true;
                                }
                                break;
                            case 'slide-intensos':
                                if (!animacoes.intensos) {
                                    animarIntensos();
                                    animacoes.intensos = true;
                                }
                                break;
                            case 'slide-vento':
                                if (!animacoes.vento) {
                                    animarVento();
                                    animacoes.vento = true;
                                }
                                break;
                        }
                    }
                });
            }, { threshold: 0.5 });

            // Observa todos os slides que precisam de anima√ß√£o
            document.querySelectorAll('.slide[id]').forEach(slide => {
                observer.observe(slide);
            });

            let resizeTimeout;
            window.addEventListener("resize", () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    animarLinha();
                    animarArea();
                    animarUmidade();
                    animarVento();
                    animarExtremos();
                    animarIntensos();

                }, 100);
            });
        </script>



        <!-- Mapa -->
        <script>
            const map = L.map('map').setView([-28.50, -53], 5.5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);

            let marcadores = [];
            let estacoes = [];
            let intervalo = null;
            let chart;

            async function carregarEstacoes() {
                const resp = await fetch('./dataset/estacoes.json');
                estacoes = await resp.json();
                preencherUFs(estacoes);
                atualizarMapa(parseInt(document.getElementById('yearSlider').value));
                desenharGrafico();
            }

            function normalizarData(data) {
                if (data.includes('/')) {
                    const [dia, mes, ano] = data.split('/');
                    return `${ano.length === 2 ? '20' + ano : ano}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;
                }
                return data;
            }

            function formatarDataParaBR(dataISO) {
                const [ano, mes, dia] = dataISO.split('-');
                return `${dia}/${mes}/${ano}`;
            }

            function preencherUFs(estacoes) {
                const select = document.getElementById('ufSelect');
                const ufs = Array.from(new Set(estacoes.map(e => e.uf))).sort();
                for (const uf of ufs) {
                    const opt = document.createElement('option');
                    opt.value = uf;
                    opt.textContent = uf;
                    select.appendChild(opt);
                }
            }

            function atualizarMapa(ano) {
                const ufSelecionado = document.getElementById('ufSelect').value;
                marcadores.forEach(m => map.removeLayer(m));
                marcadores = [];

                estacoes
                    .map(est => ({ ...est, data_fundacao: normalizarData(est.data_fundacao) }))
                    .filter(est => parseInt(est.data_fundacao.substring(0, 4)) <= ano)
                    .filter(est => ufSelecionado === 'TODOS' || est.uf === ufSelecionado)
                    .forEach(est => {
                        const dataBR = formatarDataParaBR(est.data_fundacao);
                        const marker = L.marker([est.latitude, est.longitude])
                            .bindPopup(`
                                <div style="min-width:200px;">
                                    <h5 style="margin-bottom: 0.5em; color: #1976d2;">
                                        <i class="fas fa-map-marker-alt me-2"></i> ${est.estacao}
                                    </h5>
                                    <p style="margin-bottom: 0.3em;">
                                        <span class="badge bg-primary text-white" style="font-size:0.9em;"> ${est.uf}</span>
                                    </p>
                                    <p style="margin-bottom: 0.3em;">
                                        <i class="fas fa-calendar-alt me-1"></i><strong> Inaugurada:</strong> ${dataBR}
                                    </p>
                                    ${est.municipio ? `<p style="margin-bottom: 0.3em;"><i class="fas fa-city me-1"></i><strong> Munic√≠pio:</strong> ${est.municipio}</p>` : ''}
                                    ${est.altitude ? `<p style="margin-bottom: 0.3em;"><i class="fas fa-mountain me-1"></i><strong> Altitude:</strong> ${est.altitude} m</p>` : ''}
                                    ${est.tipo ? `<p style="margin-bottom: 0.3em;"><i class="fas fa-info-circle me-1"></i><strong> Tipo:</strong> ${est.tipo}</p>` : ''}
                                </div>
                            `)
                            .addTo(map);
                        marcadores.push(marker);
                    });
            }

            function desenharGrafico() {
                const anos = {};
                estacoes.forEach(est => {
                    const ano = parseInt(normalizarData(est.data_fundacao).substring(0, 4));
                    anos[ano] = (anos[ano] || 0) + 1;
                });
                const labels = Object.keys(anos).sort((a, b) => a - b);
                const dados = labels.map(ano => anos[ano]);

                const ctx = document.getElementById('graficoEstacoes').getContext('2d');
                chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels,
                        datasets: [{
                            label: 'Esta√ß√µes por Ano de Funda√ß√£o',
                            data: dados,
                            backgroundColor: 'rgba(54, 162, 235, 0.6)'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false },
                            tooltip: { mode: 'index', intersect: false }
                        },
                        scales: {
                            x: { title: { display: true, text: 'Ano' } },
                            y: { title: { display: true, text: 'N√∫mero de Esta√ß√µes' }, beginAtZero: true }
                        }
                    }
                });
                if (marcadores.length > 0) {
                    
                        const popupContent = marcadores[0].getPopup().getContent();
                        const instrucoes = `<hr><p><strong>üìç Clique nas esta√ß√µes para mais detalhes.</strong></p>`;
                        marcadores[0].getPopup().setContent( popupContent + instrucoes);
                        marcadores[0].openPopup();
                    
                }
            }

            const slider = document.getElementById('yearSlider');
            const label = document.getElementById('yearLabel');
            const btn = document.getElementById('playBtn');
            const resetBtn = document.getElementById('resetBtn');

            slider.addEventListener('input', () => {
                const ano = parseInt(slider.value);
                label.textContent = ano;
                atualizarMapa(ano);
            });

            document.getElementById('ufSelect').addEventListener('change', () => {
                atualizarMapa(parseInt(slider.value));
            });

            resetBtn.addEventListener('click', () => {
                // O usu√°rio pode querer reiniciar a posi√ß√£o do mapa
                map.setView([-28.50, -53], 5.5);
            });

            btn.addEventListener('click', () => {
                if (intervalo) {
                    clearInterval(intervalo);
                    intervalo = null;
                    btn.textContent = '‚ñ∂Ô∏è Ver evolu√ß√£o das esta√ß√µes';
                } else {
                    // Se j√° est√° no final, reinicia do come√ßo
                    if (parseInt(slider.value) >= 2025) {
                        slider.value = 2000;
                        label.textContent = 2000;
                        atualizarMapa(2000);
                    }
                    intervalo = setInterval(() => {
                        let ano = parseInt(slider.value);
                        if (ano < 2025) {
                            ano++;
                            slider.value = ano;
                            label.textContent = ano;
                            atualizarMapa(ano);
                        } else {
                            clearInterval(intervalo);
                            intervalo = null;
                            btn.textContent = '‚ñ∂Ô∏è Reproduzir novamente';
                            setTimeout(() => {
                                btn.textContent = '‚ñ∂Ô∏è Ver evolu√ß√£o das esta√ß√µes';
                            }, 2000);
                        }
                    }, 150);
                    btn.textContent = '‚è∏Ô∏è Pausar';
                }
            });

            carregarEstacoes();
        </script>





        <script src="./assets/js/script.js"></script>
        <script src="./assets/js/d3-charts.js"></script>
        <script src="./assets/js/jquery-3.5.1.slim.min.js"></script>
        <script src="./assets/js/popper.min.js"></script>
        <script src="./assets/js/bootstrap.min.js"></script>
        <script src="./assets/js/papaparse.min.js"></script>
</body>

</html>

</body>